syntax = "proto3";

import "chisel4ml/lbir/lbir.proto";

package services;

option java_multiple_files = true;
option java_package = "services";

// Pp stands for Processing Pipeline
service PpService {
  rpc Elaborate (lbir.Model) returns (PpElaborateReturn) {}
  rpc Run (PpRunParams) returns (PpRunReturn) {}
}

message PpRunReturn {
    repeated lbir.QTensor values = 1;
}
 
message PpRunParams {
    PpHandle ppHandle = 1;
    repeated lbir.QTensor inputs = 2;
}

message PpElaborateReturn {
    PpHandle ppHandle = 1;
    ErrorMsg reply = 2;
}

message PpHandle {
    string name = 1;
    lbir.QTensor input = 2;
    repeated uint32 out_shape = 3;
}

message ErrorMsg {
    enum ErrorId {
        SUCCESS = 0;
        FAIL    = 1;
    }
    ErrorId err = 1;
    string msg = 2;
}
